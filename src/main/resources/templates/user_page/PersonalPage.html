<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Personal</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link href="https://unpkg.com/bootstrap-table@1.13.3/dist/bootstrap-table.min.css" rel="stylesheet">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.13.3/dist/bootstrap-table.min.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.13.4/dist/bootstrap-table-locale-all.min.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.13.4/dist/extensions/export/bootstrap-table-export.min.js"></script>
    <script src="https://unpkg.com/tableexport.jquery.plugin@1.10.1/tableExport.min.js"></script>

    <link rel="stylesheet" href="/css/bootstrap-datetimepicker.min.css">
    <script src="/js/bootstrap-datetimepicker.min.js"></script>
    <script type="text/javascript" src="/js/bootstrap-datetimepicker.zh-CN.js" charset="UTF-8"></script>
    <style>
        .add_content{
            margin-left: 8%;
        }

        .add_input{
            width: 80px;
            height: 15px;
            border-radius: 3px;
            margin-left: 5px;
        }

        .select{
            width: 250px;
            height: 20px;
        }

        .form-wrapper{
            margin-bottom: 10px;
        }

        .form-wrapper .label{
            float: left;
            width: 85px;
            font-size: 16px;
            line-height: 22px;
            text-align: left;
            color: #606266;
            font-weight: 300;
        }

        .add_input{
            border-radius: 4px;
            border: 1px solid #dcdfe6;
            width: 200px;
            height: 27px;
            margin-left: 2%;

        }

        .select-item{
            margin-left: 2%;
            width: 200px;
        }

        .form-control{
            height: 27px;
        }

        .radio-inline{
            margin-left: 20px;
        }
        .add_buttons{
            margin-top: 16px;
            margin-left: 10%;
        }

        .button{
            width: 80px;
            background-color: rgba(25,137,250,0.80);
            color: white;
            margin-right: 20px;
        }

        .button:hover{
            background-color: #1989fa;
            color: white;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top" role="navigation" style="margin:0;font-size: 23px;font-family: 华文楷体, serif;">
    <div class="container-fluid">
        <div class="navbar-header" style="margin-right: 40px;">
            <a class="navbar-brand" href="#" style="font-size: 30px;color: rgba(0,0,0,1)">黄疸检测云管理系统</a>
        </div>
        <div>
            <ul class="nav navbar-nav">
                <li><a href="/userHome">数据记录</a></li>
            </ul>
            <ul class="nav navbar-nav">
                <li class="active"><a href="/personal">个人中心</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a id="title-username" class="dropdown-toggle" data-toggle="dropdown" href="#">
                        username
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu" style="font-size: 18px;min-width: 115px;text-align: center;">
                        <li id="logout" style="cursor: pointer"><a>登出</a></li>
                        <li><a href="#">修改密码</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>
<div class="container" style="margin-top: 60px;">
    <div class="add_content">
        <!--<input type="text" class="cooperate-input" id="cooperate-email" placeholder="请输入邮箱进行验证">-->
        <div class="form-wrapper">
            <span class="label">注册号码:</span>
            <input type="text" class="add_input" id="add_tel" placeholder="13284281148" readonly style="border:none;outline: none;">
        </div>
        <div class="form-wrapper" id="parent">
            <div class="select">
                <span class="label">亲属关系:</span>
                <label class="radio-inline">
                    <input type="radio" name="fatherOrMather" id="optionsRadios1" value="FATHER" checked>父 亲
                </label>
                <label class="radio-inline">
                    <input type="radio" name="fatherOrMather" id="optionsRadios2"  value="MOTHER">母 亲
                </label>
            </div>
        </div>
        <div class="form-wrapper">
            <span class="label">宝宝姓名:</span>
            <input type="text" class="add_input" id="add_baby_name" placeholder="请输入宝宝姓名">
        </div>
        <div class="form-wrapper" id="sex">
            <span class="label">宝宝性别:</span>
            <div class="select">
                <label class="radio-inline">
                    <input type="radio" name="MaleOrFemale" id="optionsRadios3" value="MALE" checked>男
                </label>
                <label class="radio-inline">
                    <input type="radio" name="MaleOrFemale" id="optionsRadios4"  value="FEMALE">女
                </label>
            </div>
        </div>
        <div class="form-wrapper">
            <span class="label">怀孕周数:</span>
            <input type="text" class="add_input" id="add_week" placeholder="请输入孕周">
        </div>
        <div class="form-wrapper" id="blood" style="height: 27px;" >
            <span class="label">血型选择:</span>
            <div class="select-item" style="float: left;">
                <select class="selectpicker form-control" id="select_category" title="请选择..." style="height: 30px;">
                    <!--<option value="0">请选择</option>-->
                    <option value="O">O型</option>
                    <option value="A">A型</option>
                    <option value="B">B型</option>
                    <option value="AB">AB型</option>
                    <option value="OTHER">其他血型</option>
                </select>
            </div>

        </div>
        <div class="form-wrapper" style="margin-bottom: 20px;">
            <span class="label">出生日期:</span>
            <div class="input-group date form_date col-sm-5" data-date="" data-date-format="yyyy年MM月dd日" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd" style="float: left;margin-left: 2%;width: 200px;">
                <input class="form-control" id="birthday" size="16" type="text" value="" readonly style="background-color: white;height: 30px;">
                <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
            </div>
            <input type="hidden" id="dtp_input1" value="" /><br/>

            <script>
                $('.form_date').datetimepicker({
                    language:  'zh-CN',
                    weekStart: 1,
                    todayBtn:  1,
                    autoclose: 1,
                    todayHighlight: 1,
                    startView: 2,
                    minView: 2,
                    forceParse: 0
                });
            </script>
        </div>
        <div class="form-wrapper">
            <span class="label">出生身高:</span>
            <input type="text" class="add_input" id="add_height" placeholder="请输入身高">
        </div>
        <div class="form-wrapper">
            <span class="label">出生体重:</span>
            <input type="text" class="add_input" id="add_weight" placeholder="请输入体重">
        </div>
        <div class="form-wrapper">
            <span class="label">出生地区:</span>
            <input type="text" class="add_input" id="add_area" placeholder="请输入出生地区">
        </div>
        <div class="form-wrapper">
            <span class="label">出生医院:</span>
            <input type="text" class="add_input" id="add_hospital" placeholder="请输入出生医院">
        </div>
    </div>

    <div class="add_buttons" style="margin-bottom: 5px">
        <button class="btn button" id="modify" onclick="modifyPersonalInfo()">确定修改</button>
        <span id="error_hint"></span>
    </div>
</div>
<script>
    $("#title-username").text(localStorage.getItem("username"));
    window.onload=function (ev) {
        $.ajax({
            url:'/getOneUserInfo',
            type:'POST',
            cache:false,
            data:{
                username:localStorage.getItem('username')
            },
            success:function (data) {
                initInfo(data);
            }
        })
    };
    function initInfo(data) {
        $("#add_tel").val(data.id);
        $("#add_baby_name").val(data.nickname);
        $("#add_week").val(data.week);
        $("#add_height").val(data.height);
        $("#add_weight").val(data.weight);
        $("#add_area").val(data.area);
        $("#add_hospital").val(data.hospital);
        if(data.sex==='男'){
            $("#sex input:radio[name='MaleOrFemale'][value='MALE']").attr('checked',true);
        }else{
            $("#sex input:radio[name='MaleOrFemale'][value='FEMALE']").attr('checked',true);
        }

        if(data.parent==='父亲'){
            $("#parent input:radio[name='fatherOrMather'][value='FATHER']").attr('checked',true);
        }else{
            $("#parent input:radio[name='fatherOrMather'][value='MOTHER']").attr('checked',true);
        }
        $("#parent").val(data.parent);
        $("#select_category").val(data.blood);
        $("#birthday").val(data.bornTime);
    }
    function modifyPersonalInfo() {

        var tel=$("#add_tel").val();
        var babyName=$("#add_baby_name").val();
        var week=$("#add_week").val();
        var height=$("#add_height").val();
        var weight=$("#add_weight").val();
        var area=$("#add_area").val();
        var hospital=$("#add_hospital").val();
        var sex=$("#sex input:radio:checked").val();
        var parent=$("#parent input:radio:checked").val();
        var blood=$("#select_category option:checked").val();
        var birthday=$("#birthday").val();
        $.ajax({
            // String telephone, Role parent, String nickname, Sex sex, int week, Blood blood,
            // Date bornTime, double height, double weight, String area, String hospital
            type:'POST',
            url:'/complete',
            data:{
                telephone:tel,
                parent:parent,
                nickname:babyName,
                sex:sex,
                week:week,
                blood:blood,
                bornTime:birthday,
                height:height,
                weight:weight,
                area:area,
                hospital:hospital
            },
            success:function (data) {
                if(data==="SUCCESS"){
                    location.reload();
                }else{
                    alert("修改失败，请重试");
                }
            },
            error:function (data) {
                alert("服务器连接失败");
            }
        })
    }
    $("#logout").click(function () {
        localStorage.clear();
        window.location.href='/jaundice';
    });
</script>
</body>
</html>